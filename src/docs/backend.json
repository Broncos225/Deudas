{
  "entities": {
    "Debt": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Debt",
      "type": "object",
      "description": "Represents a debt record, including details about the debtor, amount, and associated payments and images.",
      "properties": {
        "debtorId": {
          "type": "string",
          "description": "The ID of the debtor."
        },
        "debtorName": {
            "type": "string",
            "description": "The denormalized name of the debtor for easy display."
        },
        "concept": {
          "type": "string",
          "description": "A brief description of what the debt is for."
        },
        "amount": {
          "type": "number",
          "description": "The total amount of the debt."
        },
        "currency": {
          "type": "string",
          "description": "The currency of the debt (e.g., 'COP', 'USD')."
        },
        "type": {
          "type": "string",
          "description": "The type of debt: 'iou' (I owe you) or 'uome' (you owe me).",
          "enum": ["iou", "uome"]
        },
        "createdAt": {
          "type": "string",
          "description": "The date when the debt was created.",
          "format": "date-time"
        },
        "receiptUrl": {
          "type": "string",
          "description": "URL of the receipt image.",
          "format": "uri"
        },
        "payments": {
            "type": "array",
            "items": {
                "$ref": "#/entities/Payment"
            }
        },
        "userId": {
            "type": "string",
            "description": "The ID of the user who owns this debt."
        },
        "isSettled": {
            "type": "boolean",
            "description": "Flag to know if a debt was part of a settlement"
        },
        "settlementId": {
            "type": "string",
            "description": "Which settlement it was part of"
        }
      },
      "required": [
        "debtorId",
        "debtorName",
        "concept",
        "amount",
        "currency",
        "type",
        "createdAt",
        "userId"
      ]
    },
    "Payment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Payment",
      "type": "object",
      "description": "Represents a payment made towards a debt.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Payment entity."
        },
        "amount": {
          "type": "number",
          "description": "The amount paid."
        },
        "date": {
          "type": "string",
          "description": "The date when the payment was made.",
          "format": "date-time"
        },
        "receiptUrl": {
          "type": "string",
          "description": "URL of the payment receipt image.",
          "format": "uri"
        },
        "isSettlement": {
            "type": "boolean",
            "description": "Flag to identify settlement payments."
        },
        "settlementId": {
            "type": "string",
            "description": "ID of the settlement event."
        }
      },
      "required": [
        "id",
        "amount",
        "date"
      ]
    },
    "Debtor": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Debtor",
      "type": "object",
      "description": "Represents the person or entity that owes the debt.",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the debtor."
        },
        "contact": {
          "type": "string",
          "description": "Contact information for the debtor (e.g., phone number, email address)."
        },
        "type": {
          "type": "string",
          "description": "The type of contact: 'person' or 'entity'.",
          "enum": ["person", "entity"]
        },
        "userId": {
          "type": "string",
          "description": "The ID of the user who owns this debtor."
        }
      },
      "required": [
        "name",
        "type",
        "userId"
      ]
    },
    "Settlement": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Settlement",
        "type": "object",
        "description": "Represents a settlement event where debts between a user and a debtor are crossed.",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the Settlement event."
          },
          "debtorId": {
            "type": "string",
            "description": "The ID of the debtor involved in the settlement."
          },
          "date": {
            "type": "string",
            "description": "The date when the settlement occurred.",
            "format": "date-time"
          },
          "amountSettled": {
            "type": "number",
            "description": "The total amount that was mutually cancelled out."
          },
          "currency": {
            "type": "string",
            "description": "The currency of the settlement."
          },
          "newDebtId": {
            "type": "string",
            "description": "The ID of the new debt created for the remaining balance, if any."
          },
          "userId": {
            "type": "string",
            "description": "The ID of the user who performed the settlement."
          }
        },
        "required": [
          "id",
          "debtorId",
          "date",
          "amountSettled",
          "currency",
          "userId"
        ]
      }
  },
  "auth": {
    "providers": [
      "google.com"
    ]
  },
  "firestore": {
    "collections": [
      {
        "path": "/users/{userId}/debtors/{debtorId}",
        "schema": {
          "$ref": "#/entities/Debtor"
        },
        "description": "Stores information about the people or entities who owe money."
      },
      {
        "path": "/users/{userId}/debts/{debtId}",
        "schema": {
          "$ref": "#/entities/Debt"
        },
        "description": "Stores the individual debt records."
      },
      {
        "path": "/users/{userId}/settlements/{settlementId}",
        "schema": {
          "$ref": "#/entities/Settlement"
        },
        "description": "Stores the history of debt settlement events."
      }
    ]
  }
}
